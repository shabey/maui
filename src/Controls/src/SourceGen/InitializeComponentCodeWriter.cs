using System.CodeDom.Compiler;
using System.Collections.Generic;
using System.Globalization;
using System.IO;
using System.Xml;
using System.Runtime.InteropServices;
using Microsoft.CodeAnalysis;
using Microsoft.Maui.Controls.Xaml;


namespace Microsoft.Maui.Controls.SourceGen;

static class InitializeComponentCodeWriter
{
	static readonly string NewLine = RuntimeInformation.IsOSPlatform(OSPlatform.Windows) ? "\r\n" : "\n";

    public static string GeneratedCodeAttribute => $"[global::System.CodeDom.Compiler.GeneratedCodeAttribute(\"{typeof(InitializeComponentCodeWriter).Assembly.FullName}\", \"{typeof(InitializeComponentCodeWriter).Assembly.GetName().Version}\")]";
	const string AutoGeneratedHeaderText = @"
//------------------------------------------------------------------------------
// <auto-generated>
//     This code was generated by a .NET MAUI source generator.
//
//     Changes to this file may cause incorrect behavior and will be lost if
//     the code is regenerated.
// </auto-generated>
//------------------------------------------------------------------------------
#nullable enable
";
    public static string GenerateInitializeComponent(XamlProjectItemForIC xamlItem, Compilation compilation, AssemblyCaches xmlnsCache, IDictionary<XmlType, string> typeCache)
    {
        using (var codeWriter = new IndentedTextWriter(new StringWriter(CultureInfo.InvariantCulture)))
        {
            codeWriter.WriteLine(AutoGeneratedHeaderText);

            

            codeWriter.Flush();
            return codeWriter.InnerWriter.ToString();   
        }
    }
}
